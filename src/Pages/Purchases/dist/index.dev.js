"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=Purchases;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Components=require("../../Components");var _Helix=_interopRequireWildcard(require("../../Services/Helix"));var _asyncStorage=_interopRequireDefault(require("@react-native-community/async-storage"));var _styles=require("./styles");var _noAuth=_interopRequireDefault(require("../../Assets/images/no-auth.png"));var _jsxFileName="/home/matheus/Projects/SmartMarket/src/Pages/Purchases/index.js";function Purchases(_ref){var _this=this;var navigation=_ref.navigation;var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2["default"])(_useState,2),purchases=_useState2[0],setPurchases=_useState2[1];var _useState3=(0,_react.useState)(null),_useState4=(0,_slicedToArray2["default"])(_useState3,2),userId=_useState4[0],setUserId=_useState4[1];var _useState5=(0,_react.useState)(true),_useState6=(0,_slicedToArray2["default"])(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];(0,_react.useEffect)(function(){function loadPurchases(){var response;return _regenerator["default"].async(function loadPurchases$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regenerator["default"].awrap(_Helix["default"].get("".concat(_Helix.Entities,"/?q=refClient==").concat(userId,"&attrs=*&type=Purchase")));case 3:response=_context.sent;console.log(response.data);if(response.status==200){setPurchases(response.data);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context["catch"](0);console.log("deu erro!!!",_context.t0);case 11:case"end":return _context.stop();}}},null,null,[[0,8]]);}function getUserId(){var value;return _regenerator["default"].async(function getUserId$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regenerator["default"].awrap(_asyncStorage["default"].getItem('@userId'));case 3:value=_context2.sent;console.log(value);if(value!==null){setUserId(value);setLoading(false);}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2["catch"](0);console.log("Erro ao buscar dado no local storage:",_context2.t0);case 11:case"end":return _context2.stop();}}},null,null,[[0,8]]);}getUserId().then(function(){if(userId!=null&&loading){loadPurchases();}});},[userId]);return _react["default"].createElement(_Components.Container,{__self:this,__source:{fileName:_jsxFileName,lineNumber:55,columnNumber:9}},!loading?_react["default"].createElement(_reactNative.ScrollView,{__self:this,__source:{fileName:_jsxFileName,lineNumber:57,columnNumber:17}},_react["default"].createElement(_Components.PageTitle,{text:"Minhas compras",__self:this,__source:{fileName:_jsxFileName,lineNumber:58,columnNumber:21}}),purchases.map(function(purchase,key){console.log(purchase);return _react["default"].createElement(_Components.PurchaseCard,{key:key,Price:purchase.itemsPrice.value,Id:purchase.id,__self:_this,__source:{fileName:_jsxFileName,lineNumber:63,columnNumber:33}});})):null);}